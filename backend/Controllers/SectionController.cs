using Microsoft.AspNetCore.Mvc;using ModernWMS.Backend.Models;using ModernWMS.Backend.Repositories;namespace ModernWMS.Backend.Controllers;[ApiController][Route("api/[controller]")]public class SectionController:ControllerBase{private readonly ISectionRepository _repo;private readonly ILogger<SectionController>_log;public SectionController(ISectionRepository repo,ILogger<SectionController>log){_repo=repo;_log=log;}[HttpGet]public async Task<ActionResult<IEnumerable<Section>>>GetAll(){try{return Ok(await _repo.GetAllAsync());}catch(Exception ex){_log.LogError(ex,"Error fetching sections");return StatusCode(500,ex.Message);}}[HttpGet("{id}")]public async Task<ActionResult<Section>>GetById(string id){try{var s=await _repo.GetByIdAsync(id);if(s==null)return NotFound();return Ok(s);}catch(Exception ex){_log.LogError(ex,"Error fetching section {Id}",id);return StatusCode(500,ex.Message);}}[HttpPost]public async Task<ActionResult<Section>>Create([FromBody]Section s){try{if(string.IsNullOrEmpty(s.Id))return BadRequest("Section ID required");await _repo.CreateAsync(s);return CreatedAtAction(nameof(GetById),new{id=s.Id},s);}catch(Exception ex){_log.LogError(ex,"Error creating section {Id}",s.Id);return StatusCode(500,ex.Message);}}[HttpPut("{id}")]public async Task<IActionResult>Update(string id,[FromBody]Section s){try{if(id!=s.Id)return BadRequest("ID mismatch");if(!await _repo.UpdateAsync(s))return NotFound();return NoContent();}catch(Exception ex){_log.LogError(ex,"Error updating section {Id}",id);return StatusCode(500,ex.Message);}}[HttpDelete("{id}")]public async Task<IActionResult>Delete(string id){try{if(!await _repo.DeleteAsync(id))return NotFound();return NoContent();}catch(Exception ex){_log.LogError(ex,"Error deleting section {Id}",id);return StatusCode(500,ex.Message);}}}
