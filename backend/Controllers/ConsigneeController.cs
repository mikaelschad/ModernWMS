using Microsoft.AspNetCore.Mvc;using ModernWMS.Backend.Models;using ModernWMS.Backend.Repositories;namespace ModernWMS.Backend.Controllers;[ApiController][Route("api/[controller]")]public class ConsigneeController:ControllerBase{private readonly IConsigneeRepository _repo;private readonly ILogger<ConsigneeController>_log;public ConsigneeController(IConsigneeRepository repo,ILogger<ConsigneeController>log){_repo=repo;_log=log;}[HttpGet]public async Task<ActionResult<IEnumerable<Consignee>>>GetAll(){try{return Ok(await _repo.GetAllAsync());}catch(Exception ex){_log.LogError(ex,"Error fetching consignees");return StatusCode(500,ex.Message);}}[HttpGet("{id}")]public async Task<ActionResult<Consignee>>GetById(string id){try{var c=await _repo.GetByIdAsync(id);if(c==null)return NotFound();return Ok(c);}catch(Exception ex){_log.LogError(ex,"Error fetching consignee {Id}",id);return StatusCode(500,ex.Message);}}[HttpPost]public async Task<ActionResult<Consignee>>Create([FromBody]Consignee c){try{if(string.IsNullOrEmpty(c.Id))return BadRequest("Consignee ID required");await _repo.CreateAsync(c);return CreatedAtAction(nameof(GetById),new{id=c.Id},c);}catch(Exception ex){_log.LogError(ex,"Error creating consignee {Id}",c.Id);return StatusCode(500,ex.Message);}}[HttpPut("{id}")]public async Task<IActionResult>Update(string id,[FromBody]Consignee c){try{if(id!=c.Id)return BadRequest("ID mismatch");if(!await _repo.UpdateAsync(c))return NotFound();return NoContent();}catch(Exception ex){_log.LogError(ex,"Error updating consignee {Id}",id);return StatusCode(500,ex.Message);}}[HttpDelete("{id}")]public async Task<IActionResult>Delete(string id){try{if(!await _repo.DeleteAsync(id))return NotFound();return NoContent();}catch(Exception ex){_log.LogError(ex,"Error deleting consignee {Id}",id);return StatusCode(500,ex.Message);}}}
