using Microsoft.AspNetCore.Mvc;using ModernWMS.Backend.Models;using ModernWMS.Backend.Repositories;namespace ModernWMS.Backend.Controllers;[ApiController][Route("api/[controller]")]public class ZoneController:ControllerBase{private readonly IZoneRepository _repo;private readonly ILogger<ZoneController>_log;public ZoneController(IZoneRepository repo,ILogger<ZoneController>log){_repo=repo;_log=log;}[HttpGet]public async Task<ActionResult<IEnumerable<Zone>>>GetAll(){try{return Ok(await _repo.GetAllAsync());}catch(Exception ex){_log.LogError(ex,"Error fetching zones");return StatusCode(500,ex.Message);}}[HttpGet("{id}")]public async Task<ActionResult<Zone>>GetById(string id){try{var z=await _repo.GetByIdAsync(id);if(z==null)return NotFound();return Ok(z);}catch(Exception ex){_log.LogError(ex,"Error fetching zone {Id}",id);return StatusCode(500,ex.Message);}}[HttpPost]public async Task<ActionResult<Zone>>Create([FromBody]Zone z){try{if(string.IsNullOrEmpty(z.Id))return BadRequest("Zone ID required");await _repo.CreateAsync(z);return CreatedAtAction(nameof(GetById),new{id=z.Id},z);}catch(Exception ex){_log.LogError(ex,"Error creating zone {Id}",z.Id);return StatusCode(500,ex.Message);}}[HttpPut("{id}")]public async Task<IActionResult>Update(string id,[FromBody]Zone z){try{if(id!=z.Id)return BadRequest("ID mismatch");if(!await _repo.UpdateAsync(z))return NotFound();return NoContent();}catch(Exception ex){_log.LogError(ex,"Error updating zone {Id}",id);return StatusCode(500,ex.Message);}}[HttpDelete("{id}")]public async Task<IActionResult>Delete(string id){try{if(!await _repo.DeleteAsync(id))return NotFound();return NoContent();}catch(Exception ex){_log.LogError(ex,"Error deleting zone {Id}",id);return StatusCode(500,ex.Message);}}}
